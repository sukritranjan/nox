# 1_ENTIRE_AQUEOUS_SYSTEM_ANALYSIS

#test as a function of parameter space, including pH and H2 amount
# FOR SYSTEM WITH ONLY MAXIMUM logK REACTION FOR EACH INITIAL SPECIES: RXNS 4,8,12,14,15

import numpy as np
import matplotlib
import matplotlib.pyplot as plt
from matplotlib import cm
import math
from scipy.optimize import fsolve

pH=np.array([2,4,6,8,10,12])
V=1.4E21  #Volume of oceans in L



####### RESULTS
#NO3,NO2,NO,N2O,N2,NH4

#H2=1.0E-1
#initial guess = (-10,-10,-10,-10,-4,-6)
#n=1.0E18
#(so scale by multiplying by 3.62E20/1.0E18 = 362)

pH2_n1=np.array([1.2648581718937645e-43, 6.3406279400725984e-06, 1.9300961144602721e-10, 1.9990264240784857e-19, 9.8979068879779134e-05, 1.378105485437928e-06])
pH6_n1=np.array([9.3866184137891579e-42, 3.2292498559992647e-06, 1.115836394386445e-10, 1.3495280692384726e-19, 9.8522230475848167e-05, 1.4049325047875546e-06])
pH8_n1=np.array([1.1125181383874142e-40, 5.2734707277224918e-06, 1.5246480217407706e-10, 1.6882581063988557e-19, 9.880259820925048e-05, 1.2498597098432791e-06])
pH10_n1=np.array([1.2755000785018382e-39, 7.7522838610302807e-06, 1.9596632972043486e-10, 2.0216423279502572e-19, 9.9085431051888428e-05, 1.148427359290961e-06])
pH12_n1=np.array([1.3647002943422615e-53, 5.0764456386971209e-22, 5.5387088980969409e-24, 1.8761676560729606e-31, 9.6436168450359845e-05, 1.928029960670582e-05])

pH_n1=np.array([2,6,8,10,12])
NO3_n1=np.array([1.2648581718937645e-43,9.3866184137891579e-42,1.1125181383874142e-40,1.2755000785018382e-39,1.3647002943422615e-53])
NO2_n1=np.array([6.3406279400725984e-06,3.2292498559992647e-06,5.2734707277224918e-06,7.7522838610302807e-06,5.0764456386971209e-22])
NO_n1=np.array([1.9300961144602721e-10,1.115836394386445e-10,1.5246480217407706e-10,1.9596632972043486e-10,5.5387088980969409e-24])
N2O_n1=np.array([1.9990264240784857e-19,1.3495280692384726e-19,1.6882581063988557e-19,2.0216423279502572e-19,1.8761676560729606e-31])
N2_n1=np.array([9.8979068879779134e-05,9.8522230475848167e-05,9.880259820925048e-05,9.9085431051888428e-05,9.6436168450359845e-05])
NH4_n1=np.array([1.378105485437928e-06,1.4049325047875546e-06,1.2498597098432791e-06,1.148427359290961e-06,1.928029960670582e-05])

pH2_n1=pH2_n1*362.*V   #to get corrected number of moles
pH6_n1=pH6_n1*362.*V
pH8_n1=pH8_n1*362.*V
pH10_n1=pH10_n1*362.*V
pH12_n1=pH12_n1*362.*V


pH2=np.sum(pH2_n1)+pH2_n1[4]+pH2_n1[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n1)+pH6_n1[4]+pH6_n1[3]
pH8=np.sum(pH8_n1)+pH8_n1[4]+pH8_n1[3]
pH10=np.sum(pH10_n1)+pH10_n1[4]+pH10_n1[3]
pH12=np.sum(pH12_n1)+pH12_n1[4]+pH12_n1[3]


pH2_n1=pH2_n1/pH2
pH6_n1=pH6_n1/pH6
pH8_n1=pH8_n1/pH8
pH10_n1=pH10_n1/pH10
pH12_n1=pH12_n1/pH12

#print(pH2_n1)
#print(pH6_n1)
#print(pH8_n1)
#print(pH10_n1)
#print(pH12_n1)

NO3_n1=np.array([6.14972883e-40,4.65424254e-38,5.45008248e-37,6.15970049e-36,6.43263415e-50])
NO2_n1=np.array([3.08280749e-02,1.60118494e-02,2.58340511e-02,3.74376666e-02,2.39282703e-18])
NO_n1=np.array([9.38410961e-07,5.53274139e-07,7.46905348e-07,9.46369128e-07,2.61071886e-20])
N2O_n1=np.array([9.71924814e-16,6.69147363e-16,8.27055812e-16,9.76300311e-16,8.84348027e-28])
N2_n1=np.array([4.81235325e-01,4.88510704e-01,4.84021150e-01,4.78507676e-01,4.54560311e-01])
NH4_n1=np.array([6.70033623e-03,6.96618990e-03,6.12290107e-03,5.54603538e-03,9.08793778e-02])





plt.figure()
plt.bar(pH_n1,NO3_n1,color=cm.plasma(0.05),label='NO3')
plt.bar(pH_n1,NO2_n1,bottom=NO3_n1,color=cm.plasma(0.2),label='NO2')
plt.bar(pH_n1,NO_n1,bottom=NO3_n1+NO2_n1,color=cm.plasma(0.35),label='NO')
plt.bar(pH_n1,N2O_n1*2.,bottom=NO3_n1+NO2_n1+NO_n1,color=cm.plasma(0.5),label='N2O')
plt.bar(pH_n1,N2_n1*2.,bottom=NO3_n1+NO2_n1+NO_n1+N2O_n1*2.,color=cm.plasma(0.65),label='N2')
plt.bar(pH_n1,NH4_n1,bottom=NO3_n1+NO2_n1+NO_n1+N2O_n1*2.+N2_n1*2.,color=cm.plasma(0.8),label='NH4')
plt.legend(loc='best')
plt.xlabel('pH')
plt.ylabel('Mole fraction')
plt.show()
plt.close()

#H2=1.0E-3
#initial guess: (-10,-10,-10,-10,-4,-6)  ((-10,-10,-10,-10,-4,-5) for pH 8)
#n=1.0E18  

pH4_n3=np.array([3.2302607599506705e-40, 4.1355977071970428e-06, 1.3034596945793322e-10, 1.6031102546007352e-19, 9.8662135395426368e-05, 1.3212298379768768e-06])
pH6_n3=np.array([3.8237803933553034e-39, 6.6511771586381973e-06, 1.7769732465620993e-10, 1.9779492829856413e-19, 9.8943622547057136e-05, 1.1902850166782315e-06])
pH8_n3=np.array([5.273975705328952e-57, 2.2365112887358784e-33, 4.1094184242917522e-34, 8.2331797658607456e-42, 3.35858401922908e-05, 0.00064708281493323005])
pH10_n3=np.array([6.1354086198242032e-37, 3.4861795520516989e-30, 2.6361369479037932e-26, 2.0863201310965201e-24, 9.8224742299828091e-05, 0.0001495895575980999])
pH12_n3=np.array([3.6475082818634697e-88, 3.6475104734641059e-61, 1.6290117486098295e-59, 6.6657425647580671e-61, 0.00033418924277494195, 4.5911792109434591e-05])

pH_n3=np.array([4,6,8,10,12])
NO3_n3=np.array([3.2302607599506705e-40,3.8237803933553034e-39,5.273975705328952e-57,6.1354086198242032e-37,3.6475082818634697e-88])
NO2_n3=np.array([4.1355977071970428e-06,6.6511771586381973e-06,2.2365112887358784e-33,3.4861795520516989e-30,3.6475104734641059e-61])
NO_n3=np.array([1.3034596945793322e-10,1.7769732465620993e-10,4.1094184242917522e-34,2.6361369479037932e-26,1.6290117486098295e-59])
N2O_n3=np.array([1.6031102546007352e-19,1.9779492829856413e-19,8.2331797658607456e-42,2.0863201310965201e-24,6.6657425647580671e-61])
N2_n3=np.array([9.8662135395426368e-05,9.8943622547057136e-05,3.35858401922908e-05,9.8224742299828091e-05,0.00033418924277494195])
NH4_n3=np.array([1.3212298379768768e-06,1.1902850166782315e-06,0.00064708281493323005,0.0001495895575980999,4.5911792109434591e-05])


pH4_n3=pH4_n3*362.*V   #to get corrected number of moles
pH6_n3=pH6_n3*362.*V
pH8_n3=pH8_n3*362.*V
pH10_n3=pH10_n3*362.*V
pH12_n3=pH12_n3*362.*V


pH4=np.sum(pH4_n3)+pH4_n3[4]+pH4_n3[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n3)+pH6_n3[4]+pH6_n3[3]
pH8=np.sum(pH8_n3)+pH8_n3[4]+pH8_n3[3]
pH10=np.sum(pH10_n3)+pH10_n3[4]+pH10_n3[3]
pH12=np.sum(pH12_n3)+pH12_n3[4]+pH12_n3[3]


pH4_n3=pH4_n3/pH4
pH6_n3=pH6_n3/pH6
pH8_n3=pH8_n3/pH8
pH10_n3=pH10_n3/pH10
pH12_n3=pH12_n3/pH12

#print(pH4_n3)
#print(pH6_n3)
#print(pH8_n3)
#print(pH10_n3)
#print(pH12_n3)

NO3_n3=np.array([1.59297820e-36,1.85865023e-35,7.38388871e-54,1.77303942e-33,5.10647897e-85])
NO2_n3=np.array([2.03943813e-02,3.23298168e-02,3.13125266e-30,1.00745266e-26,5.10648204e-58])
NO_n3=np.array([6.42791102e-07,8.63745141e-07,5.75343726e-31,7.61803330e-23,2.28060188e-56])
N2O_n3=np.array([7.90561466e-16,9.61434892e-16,1.15269555e-38,6.02914665e-21,9.33197997e-58])
N2_n3=np.array([4.86544716e-01,4.80941811e-01,4.70222314e-02,2.83854509e-01,4.67861951e-01])
NH4_n3=np.array([6.51554311e-03,5.78569712e-03,9.05955537e-01,4.32290983e-01,6.42760983e-02])



#H2=1E-5
#initial guess: (-10,-10,-10,-10,-4,-6)
#n=1.0E18

pH2_n5=np.array([1.1124438493931144e-38, 5.2735463234455368e-06, 1.5246507730138914e-10, 1.8827811160748396e-19, 9.8802597594988394e-05, 1.2498597634561608e-06])
pH4_n5=np.array([1.2754072144409714e-37, 7.7523952150421566e-06, 1.9596642137934197e-10, 2.2105748856345746e-19, 9.9085430285010805e-05, 1.1484276345147607e-06])
pH6_n5=np.array([4.9974740212428524e-51, 5.076817052211572e-22, 5.5388822832895755e-24, 2.8096109201754259e-30, 9.6436167664601857e-05, 1.9280256392226557e-05])
pH8_n5=np.array([2.7204459232313685e-87, 2.7204459366307906e-62, 1.2151785620991579e-59, 3.7091995426033615e-59, 0.0001859003460758192, 0.00034248385173311165])
pH10_n5=np.array([3.12342374886599e-85, 3.1254586678312828e-60, 7.9332295889252393e-58, 1.5805311908962246e-55, 0.00024531403743944738, 0.00022358215740089007])
pH12_n5=np.array([3.7705584586905876e-83, 3.7705569001683895e-58, 1.6842460080665987e-59, 7.1254323113383249e-59, 0.00035711743772477814, 4.7468502380103712e-08])

pH_n5=np.array([2,4,6,8,10,12])

NO3_n5=np.array([1.1124438493931144e-38,1.2754072144409714e-37,4.9974740212428524e-51,2.7204459232313685e-87,3.12342374886599e-85,3.7705584586905876e-83])
NO2_n5=np.array([5.2735463234455368e-06,7.7523952150421566e-06,5.076817052211572e-22,2.7204459366307906e-62,3.1254586678312828e-60,3.7705569001683895e-58])
NO_n5=np.array([1.5246507730138914e-10,1.9596642137934197e-10,5.5388822832895755e-24,1.2151785620991579e-59,7.9332295889252393e-58,1.6842460080665987e-59])
N2O_n5=np.array([1.8827811160748396e-19,2.2105748856345746e-19,2.8096109201754259e-30,3.7091995426033615e-59,1.5805311908962246e-55,7.1254323113383249e-59])
N2_n5=np.array([9.8802597594988394e-05,9.9085430285010805e-05,9.6436167664601857e-05,0.0001859003460758192,0.00024531403743944738,0.00035711743772477814])
NH4_n5=np.array([1.2498597634561608e-06,1.1484276345147607e-06,1.9280256392226557e-05,0.00034248385173311165,0.00022358215740089007,4.7468502380103712e-08])

NO3_n5=NO3_n5*362.
NO2_n5=NO2_n5*362.
NO_n5=NO_n5*362.
N2O_n5=N2O_n5*362.
N2_n5=N2_n5*362.
NH4_n5=NH4_n5*362.


pH2_n5=pH2_n5*362.*V
pH4_n5=pH4_n5*362.*V   #to get corrected number of moles
pH6_n5=pH6_n5*362.*V
pH8_n5=pH8_n5*362.*V
pH10_n5=pH10_n5*362.*V
pH12_n5=pH12_n5*362.*V

pH2=np.sum(pH2_n5)+pH2_n5[4]+pH2_n5[3]
pH4=np.sum(pH4_n5)+pH4_n5[4]+pH4_n5[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n5)+pH6_n5[4]+pH6_n5[3]
pH8=np.sum(pH8_n5)+pH8_n5[4]+pH8_n5[3]
pH10=np.sum(pH10_n5)+pH10_n5[4]+pH10_n5[3]
pH12=np.sum(pH12_n5)+pH12_n5[4]+pH12_n5[3]

pH2_n5=pH2_n5/pH2
pH4_n5=pH4_n5/pH4
pH6_n5=pH6_n5/pH6
pH8_n5=pH8_n5/pH8
pH10_n5=pH10_n5/pH10
pH12_n5=pH12_n5/pH12

#print(pH2_n5)
#print(pH4_n5)
#print(pH6_n5)
#print(pH8_n5)
#print(pH10_n5)
#print(pH12_n5)

NO3_n5=np.array([5.44971656e-35,6.15924875e-34,2.35560357e-47,3.80863053e-84,4.37325539e-82,5.27880675e-80])
NO2_n5=np.array([2.58344120e-02,3.74381845e-02,2.39300261e-18,3.80863055e-59,4.37610458e-57,5.27880457e-55])
NO_n5=np.array([7.46906423e-07,9.46369067e-07,2.61080114e-20,1.70125277e-56,1.11076952e-54,2.35795554e-56])
N2O_n5=np.array([9.22349782e-16,1.06753988e-15,1.32433495e-26,5.19288787e-56,2.21297752e-52,9.97565231e-56])
N2_n5=np.array([4.84020971e-01,4.78507418e-01,4.54560403e-01,2.60260911e-01,3.43475949e-01,4.99966772e-01])
NH4_n5=np.array([6.12289910e-03,5.54603376e-03,9.08791933e-02,4.79478178e-01,3.13048102e-01,6.64562169e-05])



#H2=1E-8
#initial guess: (-10,-10,-10,-10,-4,-6)
#n=1.0E18

pH_n8=np.array([2,4,6,8,10,12])

pH2_n8=np.array([6.0381509716155669e-53, 1.1891374614129172e-46, 2.1397235579123482e-42, 2.0705299221212638e-37, 0.00010116342786990882, 0.00049378701535912769])
pH4_n8=np.array([1.0736674606425115e-83, 1.0736674744923381e-61, 1.5165956144685473e-59, 5.7774951477433211e-56, 0.00028956068227581718, 0.00013516672636215701])
pH6_n8=np.array([1.9231112359891434e-47, 1.6358965448920249e-68, 6.8425644747335289e-61, 4.4394243534653139e-43, 0.00017327465661571431, 1.0456100010398247e-06])
pH8_n8=np.array([1.1923848939994372e-79, 1.1923848935275283e-57, 1.6842884359099122e-59, 7.1257886474171146e-56, 0.0003571354272494503, 1.5011236484584208e-08])
pH10_n8=np.array([1.192397327618662e-77, 1.1923973349547283e-55, 1.6843060000404725e-59, 7.1259371930355628e-56, 0.00035714287572425111, 1.5011393022201266e-10])
pH12_n8=np.array([1.1923975044486117e-75, 1.1923974879623105e-53, 1.6843062197041223e-59, 7.1259390419080124e-56, 0.00035714296938215291, 1.5011394990510844e-12])


NO3_n8=np.array([6.0381509716155669e-53,1.0736674606425115e-83,1.9231112359891434e-47,1.1923848939994372e-79,1.192397327618662e-77,1.1923975044486117e-75])
NO2_n8=np.array([1.1891374614129172e-46,1.0736674744923381e-61,1.6358965448920249e-68,1.1923848935275283e-57,1.1923973349547283e-55,1.1923974879623105e-53])
NO_n8=np.array([2.1397235579123482e-42,1.5165956144685473e-59,6.8425644747335289e-61,1.6842884359099122e-59,1.6843060000404725e-59,1.6843062197041223e-59])
N2O_n8=np.array([2.0705299221212638e-37,5.7774951477433211e-56,4.4394243534653139e-43,7.1257886474171146e-56,7.1259371930355628e-56,7.1259390419080124e-56])
N2_n8=np.array([0.00010116342786990882,0.00028956068227581718,0.00017327465661571431,0.0003571354272494503,0.00035714287572425111,0.00035714296938215291])
NH4_n8=np.array([0.00049378701535912769,0.00013516672636215701,1.0456100010398247e-06,1.5011236484584208e-08,1.5011393022201266e-10,1.5011394990510844e-12])

NO3_n8=NO3_n8*362.
NO2_n8=NO2_n8*362.
NO_n8=NO_n8*362.
N2O_n8=N2O_n8*362.
N2_n8=N2_n8*362.
NH4_n8=NH4_n8*362.


pH2_n8=pH2_n8*362.*V
pH4_n8=pH4_n8*362.*V   #to get corrected number of moles
pH6_n8=pH6_n8*362.*V
pH8_n8=pH8_n8*362.*V
pH10_n8=pH10_n8*362.*V
pH12_n8=pH12_n8*362.*V

pH2=np.sum(pH2_n8)+pH2_n8[4]+pH2_n8[3]
pH4=np.sum(pH4_n8)+pH4_n8[4]+pH4_n8[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n8)+pH6_n8[4]+pH6_n8[3]
pH8=np.sum(pH8_n8)+pH8_n8[4]+pH8_n8[3]
pH10=np.sum(pH10_n8)+pH10_n8[4]+pH10_n8[3]
pH12=np.sum(pH12_n8)+pH12_n8[4]+pH12_n8[3]

pH2_n8=pH2_n8/pH2
pH4_n8=pH4_n8/pH4
pH6_n8=pH6_n8/pH6
pH8_n8=pH8_n8/pH8
pH10_n8=pH10_n8/pH10
pH12_n8=pH12_n8/pH12

#print(pH2_n8)
#print(pH4_n8)
#print(pH6_n8)
#print(pH8_n8)
#print(pH10_n8)
#print(pH12_n8)

NO3_n8=np.array([8.67408512e-50,1.50312944e-80,5.53262176e-44,1.66933850e-76,1.66935582e-74,1.66935598e-72])
NO2_n8=np.array([1.70825135e-43,1.50312946e-58,4.70633037e-65,1.66933850e-54,1.66935583e-52,1.66935596e-50])
NO_n8=np.array([3.07381256e-39,2.12322680e-56,1.96854557e-57,2.35800331e-56,2.35802778e-56,2.35802796e-56])
N2O_n8=np.array([2.97441268e-34,8.08846629e-53,1.27718331e-39,9.97610199e-53,9.97630945e-53,9.97631150e-53])
N2_n8=np.array([1.45325976e-01,4.05383606e-01,4.98495936e-01,4.99989492e-01,4.99999895e-01,4.99999999e-01])
NH4_n8=np.array([7.09348048e-01,1.89232787e-01,3.00812794e-03,2.10157266e-05,2.10159447e-07,2.10159463e-09])



#H2=1E-10
#initial guess: (-10,-10,-10,-10,-4,-6)
#n=1.0E18

pH_n10=np.array([2,4,6,8,10,12])

pH2_n10=np.array([8.3273336249083555e-81, 8.3273336244538508e-61, 4.1073411848694789e-58, 4.2376156233924567e-51, 0.00017415800139600183, 0.00036601534635275271])
pH4_n10=np.array([8.2102089711699588e-79, 8.2102085802336026e-59, 4.2219106419482988e-56, 4.4773185603137641e-47, 0.00016916613327816449, 0.00037600695651830197])
pH6_n10=np.array([1.1923961820913141e-76, 1.1923961887308181e-56, 1.6843043857198595e-59, 7.12592350719617e-54, 0.00035714219098076979, 1.50113786316602e-09])
pH8_n10=np.array([1.1923974499417903e-74, 1.1923974600509126e-54, 1.6843061824316145e-59, 7.1259386845793644e-54, 0.00035714295282561026, 1.5011394642559411e-11])
pH10_n10=np.array([1.192397508114636e-72, 1.1923975021806351e-52, 1.6843062451536842e-59, 7.1259391442257775e-54, 0.0003571429800110509, 1.5011395213887186e-13])
pH12_n10=np.array([1.1923975240090259e-70, 1.1923975434297389e-50, 1.6843062935727071e-59, 7.1259396583718335e-54, 0.00035714300004559323, 1.5011395634932026e-15])

NO3_n10=np.array([8.3273336249083555e-81,8.2102089711699588e-79,1.1923961820913141e-76,1.1923974499417903e-74,1.192397508114636e-72,1.1923975240090259e-70])
NO2_n10=np.array([8.3273336244538508e-61,8.2102085802336026e-59,1.1923961887308181e-56,1.1923974600509126e-54,1.1923975021806351e-52,1.1923975434297389e-50])
NO_n10=np.array([4.1073411848694789e-58,4.2219106419482988e-56,1.6843043857198595e-59,1.6843061824316145e-59,1.6843062451536842e-59,1.6843062935727071e-59])
N2O_n10=np.array([4.2376156233924567e-51,4.4773185603137641e-47,7.12592350719617e-54,7.1259386845793644e-54,7.1259391442257775e-54,7.1259396583718335e-54])
N2_n10=np.array([0.00017415800139600183,0.00016916613327816449,0.00035714219098076979,0.00035714295282561026,0.0003571429800110509,0.00035714300004559323])
NH4_n10=np.array([0.00036601534635275271,0.00037600695651830197,1.50113786316602e-09,1.5011394642559411e-11,1.5011395213887186e-13,1.5011395634932026e-15])

NO3_n10=NO3_n10*362.
NO2_n10=NO2_n10*362.
NO_n10=NO_n10*362.
N2O_n10=N2O_n10*362.
N2_n10=N2_n10*362.
NH4_n10=NH4_n10*362.


pH2_n10=pH2_n10*362.*V
pH4_n10=pH4_n10*362.*V   #to get corrected number of moles
pH6_n10=pH6_n10*362.*V
pH8_n10=pH8_n10*362.*V
pH10_n10=pH10_n10*362.*V
pH12_n10=pH12_n10*362.*V

pH2=np.sum(pH2_n10)+pH2_n10[4]+pH2_n10[3]
pH4=np.sum(pH4_n10)+pH4_n10[4]+pH4_n10[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n10)+pH6_n10[4]+pH6_n10[3]
pH8=np.sum(pH8_n10)+pH8_n10[4]+pH8_n10[3]
pH10=np.sum(pH10_n10)+pH10_n10[4]+pH10_n10[3]
pH12=np.sum(pH12_n10)+pH12_n10[4]+pH12_n10[3]

pH2_n10=pH2_n10/pH2
pH4_n10=pH4_n10/pH4
pH6_n10=pH6_n10/pH6
pH8_n10=pH8_n10/pH8
pH10_n10=pH10_n10/pH10
pH12_n10=pH12_n10/pH12

#print(pH2_n10)
#print(pH4_n10)
#print(pH6_n10)
#print(pH8_n10)
#print(pH10_n10)
#print(pH12_n10)

NO3_n10=np.array([1.16575223e-77,1.14934316e-75,1.66935426e-73,1.66935595e-71,1.66935594e-69,1.66935587e-67])
NO2_n10=np.array([1.16575223e-57,1.14934310e-55,1.66935427e-53,1.66935596e-51,1.66935593e-49,1.66935589e-47])
NO_n10=np.array([5.74991030e-55,5.91023215e-53,2.35802558e-56,2.35802797e-56,2.35802793e-56,2.35802787e-56])
N2O_n10=np.array([5.93228287e-48,6.26777645e-44,9.97629055e-51,9.97631128e-51,9.97631137e-51,9.97631153e-51])
N2_n10=np.array([2.43805626e-01,2.36814846e-01,4.99998949e-01,4.99999989e-01,5.00000000e-01,5.00000000e-01])
NH4_n10=np.array([5.12388749e-01,5.26370308e-01,2.10159251e-06,2.10159464e-08,2.10159461e-10,2.10159455e-12])



#H2=1E-15
#initial guess: (-10,-10,-10,-8,-4,-10)
#n=1.0E18

pH_n15=np.array([2,4,6,8,10,12])

pH2_n15=np.array([1.3278460286734069e-75, 1.0481038206787886e-61, 1.6291175195908809e-60, 3.2959912701545466e-49, 0.00017249937820699117, 3.2990737852706189e-13])
pH4_n15=np.array([3.7706918084962129e-66, 3.7706918025206291e-51, 1.6843061377357778e-59, 7.1259383798912509e-49, 0.00035714293435588587, 4.7470196698671294e-15])
pH6_n15=np.array([3.7706917879268338e-64, 3.770691667347024e-49, 1.6843061375687569e-59, 7.1259383797520459e-49, 0.00035714293435864971, 4.7470196698855168e-17])
pH8_n15=np.array([3.7706917891892932e-62, 3.7706917163538822e-47, 1.6843061339427386e-59, 7.1259383799164332e-49, 0.00035714293435907044, 4.7470196698882741e-19])
pH10_n15=np.array([3.7706917937634882e-60, 3.7706918101783615e-45, 1.684306136587739e-59, 7.125938379760557e-49, 0.00035714293435948162, 4.7470196698909926e-21])
pH12_n15=np.array([3.7706917512678824e-58, 3.7706917719054303e-43, 1.6843061386630878e-59, 7.1259383799301903e-49, 0.00035714293435988007, 4.7470196698936718e-23])

NO3_n15=np.array([1.3278460286734069e-75,3.7706918084962129e-66,3.7706917879268338e-64,3.7706917891892932e-62,3.7706917937634882e-60,3.7706917512678824e-58])
NO2_n15=np.array([1.0481038206787886e-61,3.7706918025206291e-51,3.770691667347024e-49,3.7706917163538822e-47,3.7706918101783615e-45,3.7706917719054303e-43])
NO_n15=np.array([1.6291175195908809e-60,1.6843061377357778e-59,1.6843061375687569e-59,1.6843061339427386e-59,1.684306136587739e-59,1.6843061386630878e-59])
N2O_n15=np.array([3.2959912701545466e-49,7.1259383798912509e-49,7.1259383797520459e-49,7.1259383799164332e-49,7.125938379760557e-49,7.1259383799301903e-49])
N2_n15=np.array([0.00017249937820699117,0.00035714293435588587,0.00035714293435864971,0.00035714293435907044,0.00035714293435948162,0.00035714293435988007])
NH4_n15=np.array([3.2990737852706189e-13,4.7470196698671294e-15,4.7470196698855168e-17,4.7470196698882741e-19,4.7470196698909926e-21,4.7470196698936718e-23])

NO3_n15=NO3_n15*362.
NO2_n15=NO2_n15*362.
NO_n15=NO_n15*362.
N2O_n15=N2O_n15*362.
N2_n15=N2_n15*362.
NH4_n15=NH4_n15*362.


pH2_n15=pH2_n15*362.*V
pH4_n15=pH4_n15*362.*V   #to get corrected number of moles
pH6_n15=pH6_n15*362.*V
pH8_n15=pH8_n15*362.*V
pH10_n15=pH10_n15*362.*V
pH12_n15=pH12_n15*362.*V

pH2=np.sum(pH2_n15)+pH2_n15[4]+pH2_n15[3]
pH4=np.sum(pH4_n15)+pH4_n15[4]+pH4_n15[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n15)+pH6_n15[4]+pH6_n15[3]
pH8=np.sum(pH8_n15)+pH8_n15[4]+pH8_n15[3]
pH10=np.sum(pH10_n15)+pH10_n15[4]+pH10_n15[3]
pH12=np.sum(pH12_n15)+pH12_n15[4]+pH12_n15[3]

pH2_n15=pH2_n15/pH2
pH4_n15=pH4_n15/pH4
pH6_n15=pH6_n15/pH6
pH8_n15=pH8_n15/pH8
pH10_n15=pH10_n15/pH10
pH12_n15=pH12_n15/pH12

#print(pH2_n15)
#print(pH4_n15)
#print(pH6_n15)
#print(pH8_n15)
#print(pH10_n15)
#print(pH12_n15)

NO3_n15=np.array([3.84884294e-72,5.27896739e-63,5.27896736e-61,5.27896736e-59,5.27896737e-57,5.27896731e-55])
NO2_n15=np.array([3.03799304e-58,5.27896738e-48,5.27896719e-46,5.27896726e-44,5.27896739e-42,5.27896734e-40])
NO_n15=np.array([4.72209678e-57,2.35802808e-56,2.35802808e-56,2.35802808e-56,2.35802808e-56,2.35802808e-56])
N2O_n15=np.array([9.55363231e-46,9.97631157e-46,9.97631157e-46,9.97631157e-46,9.97631157e-46,9.97631157e-46])
N2_n15=np.array([5.00000000e-01,5.00000000e-01,5.00000000e-01,5.00000000e-01,5.00000000e-01,5.00000000e-01])
NH4_n15=np.array([9.56256717e-10,6.64582610e-12,6.64582610e-14,6.64582610e-16,6.64582610e-18,6.64582610e-20])



#H2=1E-30
#initial guess: (-4,-6,-6,-6,-6,-6)
#n=1.0E18

pH_n30=np.array([2,4,6,8,10,12])

pH2_n30=np.array([1.5422781429131904e-05, 1.0834705515420746e-08, 1.2343112750664692e-09, 3.5220460437811981e-05, 0.00031421105589987593, 9.4051698771981849e-24])
pH4_n30=np.array([7.1251223992071594e-05, 9.2067765574579098e-05, 5.6041002696770433e-08, 0.00010002294097832701, 0.00011762242716042378, 0.00011567890087125205])
pH6_n30=np.array([0.00034364609523764527, 9.2340615834504228e-05, 1.1003142503430474e-07, 4.574918094272139e-05, 5.1455797109378579e-05, 8.3876489720217308e-05])
pH8_n30=np.array([0.00035692567056010534, 9.8473672168949966e-05, 4.3614968977186925e-08, 4.0614184388926648e-05, 5.345918296635261e-05, 7.0758790991349598e-05])
pH10_n30=np.array([0.00021542651675950816, 0.00013659881671205924, 8.4524064993821299e-09, 8.2888544331922916e-05, 9.4224387662132997e-05, 7.8471801756147822e-06])
pH12_n30=np.array([0.00018421543199702208, 0.0002567187200829456, 4.2512122664281322e-09, 5.9463398998150312e-05, 7.7068318769071457e-05, 3.0922552668869225e-07])

NO3_n30=np.array([1.5422781429131904e-05,7.1251223992071594e-05,0.00034364609523764527,0.00035692567056010534,0.00021542651675950816,0.00018421543199702208])
NO2_n30=np.array([1.0834705515420746e-08,9.2067765574579098e-05,9.2340615834504228e-05,9.8473672168949966e-05,0.00013659881671205924,0.0002567187200829456])
NO_n30=np.array([1.2343112750664692e-09,5.6041002696770433e-08,1.1003142503430474e-07,4.3614968977186925e-08,8.4524064993821299e-09,4.2512122664281322e-09])
N2O_n30=np.array([3.5220460437811981e-05,0.00010002294097832701,4.574918094272139e-05,4.0614184388926648e-05,8.2888544331922916e-05,5.9463398998150312e-05])
N2_n30=np.array([0.00031421105589987593,0.00011762242716042378,5.1455797109378579e-05,5.345918296635261e-05,9.4224387662132997e-05,7.7068318769071457e-05])
NH4_n30=np.array([9.4051698771981849e-24,0.00011567890087125205,8.3876489720217308e-05,7.0758790991349598e-05,7.8471801756147822e-06,3.0922552668869225e-07])

NO3_n30=NO3_n30*362.
NO2_n30=NO2_n30*362.
NO_n30=NO_n30*362.
N2O_n30=N2O_n30*362.
N2_n30=N2_n30*362.
NH4_n30=NH4_n30*362.


pH2_n30=pH2_n30*362.*V
pH4_n30=pH4_n30*362.*V   #to get corrected number of moles
pH6_n30=pH6_n30*362.*V
pH8_n30=pH8_n30*362.*V
pH10_n30=pH10_n30*362.*V
pH12_n30=pH12_n30*362.*V

pH2=np.sum(pH2_n30)+pH2_n30[4]+pH2_n30[3]
pH4=np.sum(pH4_n30)+pH4_n30[4]+pH4_n30[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n30)+pH6_n30[4]+pH6_n30[3]
pH8=np.sum(pH8_n30)+pH8_n30[4]+pH8_n30[3]
pH10=np.sum(pH10_n30)+pH10_n30[4]+pH10_n30[3]
pH12=np.sum(pH12_n30)+pH12_n30[4]+pH12_n30[3]

pH2_n30=pH2_n30/pH2
pH4_n30=pH4_n30/pH4
pH6_n30=pH6_n30/pH6
pH8_n30=pH8_n30/pH8
pH10_n30=pH10_n30/pH10
pH12_n30=pH12_n30/pH12

#print(pH2_n30)
#print(pH4_n30)
#print(pH6_n30)
#print(pH8_n30)
#print(pH10_n30)
#print(pH12_n30)

NO3_n30=np.array([2.15915262e-02,9.97434813e-02,4.81038889e-01,4.99652031e-01,3.01672674e-01,2.57892452e-01])
NO2_n30=np.array([1.51683293e-05,1.28884234e-01,1.29259223e-01,1.37851027e-01,1.91286249e-01,3.59393453e-01])
NO_n30=np.array([1.72800635e-06,7.84509288e-05,1.54022977e-04,6.10555912e-05,1.18363334e-05,5.95148595e-06])
N2O_n30=np.array([4.93078046e-02,1.40020561e-01,6.40401142e-02,5.68548619e-02,1.16073031e-01,8.32458042e-02])
N2_n30=np.array([4.39887984e-01,1.64657808e-01,7.20282867e-02,7.48362798e-02,1.31947187e-01,1.07891817e-01])
NH4_n30=np.array([1.31670135e-20,1.61937096e-01,1.17411063e-01,9.90536029e-02,1.09888043e-02,4.32900374e-04])


#H2=1E-35 
#initial guess: (-4,-6,-6,-6,-6,-6)
#n=1.0E18

pH_n35=np.array([2,4,6,8,10,12])

pH2_n35=np.array([0.00018148342947109069, 0.00016000063878042248, 7.4094052668219549e-09, 6.3501252592634879e-05, 0.00011863692053387209, 8.4286744456354922e-06])
pH4_n35=np.array([0.00017998450467790667, 9.8663114797575743e-05, 1.8002592331720226e-09, 7.3669361951699328e-05, 0.00014385822081303641, 6.5244147366921858e-07])
pH6_n35=np.array([0.00032982262687816257, 0.00013942526648921648, 4.4756872810186024e-09, 6.9925214186096382e-05, 5.2447080954592328e-05, 3.1224055427886336e-07])
pH8_n35=np.array([0.00013630770626581499, 0.00018777509967665899, 5.1105102052666786e-10, 0.00011192198938986534, 8.3224726933507965e-05, 3.931204741586797e-09])
pH10_n35=np.array([0.00018189889291757202, 0.00042067174747020375, 1.0174275093279185e-08, 3.1202633499295479e-05, 2.4728372544499648e-05, 3.6840100884834046e-08])
pH12_n35=np.array([0.00011958440951950732, 2.9188299516180516e-05, 2.5660132078995518e-06, 3.2759142001072097e-05, 0.00019336522606877419, 2.0393080372039647e-05])

NO3_n35=np.array([0.00018148342947109069,0.00017998450467790667,0.00032982262687816257,0.00013630770626581499,0.00018189889291757202,0.00011958440951950732])
NO2_n35=np.array([0.00016000063878042248,9.8663114797575743e-05,0.00013942526648921648,0.00018777509967665899,0.00042067174747020375,2.9188299516180516e-05])
NO_n35=np.array([7.4094052668219549e-09,1.8002592331720226e-09,4.4756872810186024e-09,5.1105102052666786e-10,1.0174275093279185e-08,2.5660132078995518e-06])
N2O_n35=np.array([6.3501252592634879e-05,7.3669361951699328e-05,6.9925214186096382e-05,0.00011192198938986534,3.1202633499295479e-05,3.2759142001072097e-05])
N2_n35=np.array([0.00011863692053387209,0.00014385822081303641,5.2447080954592328e-05,8.3224726933507965e-05,2.4728372544499648e-05,0.00019336522606877419])
NH4_n35=np.array([8.4286744456354922e-06,6.5244147366921858e-07,3.1224055427886336e-07,3.931204741586797e-09,3.6840100884834046e-08,2.0393080372039647e-05])

NO3_n35=NO3_n35*362.
NO2_n35=NO2_n35*362.
NO_n35=NO_n35*362.
N2O_n35=N2O_n35*362.
N2_n35=N2_n35*362.
NH4_n35=NH4_n35*362.


pH2_n35=pH2_n35*362.*V
pH4_n35=pH4_n35*362.*V   #to get corrected number of moles
pH6_n35=pH6_n35*362.*V
pH8_n35=pH8_n35*362.*V
pH10_n35=pH10_n35*362.*V
pH12_n35=pH12_n35*362.*V

pH2=np.sum(pH2_n35)+pH2_n35[4]+pH2_n35[3]
pH4=np.sum(pH4_n35)+pH4_n35[4]+pH4_n35[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n35)+pH6_n35[4]+pH6_n35[3]
pH8=np.sum(pH8_n35)+pH8_n35[4]+pH8_n35[3]
pH10=np.sum(pH10_n35)+pH10_n35[4]+pH10_n35[3]
pH12=np.sum(pH12_n35)+pH12_n35[4]+pH12_n35[3]

pH2_n35=pH2_n35/pH2
pH4_n35=pH4_n35/pH4
pH6_n35=pH6_n35/pH6
pH8_n35=pH8_n35/pH8
pH10_n35=pH10_n35/pH10
pH12_n35=pH12_n35/pH12

#print(pH2_n35)
#print(pH4_n35)
#print(pH6_n35)
#print(pH8_n35)
#print(pH10_n35)
#print(pH12_n35)

NO3_n35=np.array([2.54108540e-01,2.51953152e-01,4.61736496e-01,1.90805421e-01,2.54589321e-01,0.19164766])
NO2_n35=np.array([2.24028876e-01,1.38114572e-01,1.95188955e-01,2.62850193e-01,5.88780573e-01,0.04677758])
NO_n35=np.array([1.03744632e-05,2.52011132e-06,6.26575618e-06,7.15376317e-07,1.42401185e-05,0.00411233])
N2O_n35=np.array([8.89128591e-02,1.03126811e-01,9.78920812e-02,1.56669955e-01,4.36718285e-02,0.05250026])
N2_n35=np.array([1.66112437e-01,2.01381404e-01,7.34234992e-02,1.16499129e-01,3.46103237e-02,0.30988983])
NH4_n35=np.array([1.18016183e-02,9.13326879e-04,4.37122403e-04,5.50295500e-06,5.15621404e-05,0.03268224])



#H2=1E-50
#initial guess: (-4,-5,-6,-6,-6,-6)
#n=1.0E18

pH_n50=np.array([2,4,6,8,10,12])

pH2_n50=np.array([4.3683387700727359e-05, 9.4257293481906612e-05, 0.000269245568543949, 4.8808065373787774e-05, 5.2885920780133285e-05, 0.00010371054066315315])
pH4_n50=np.array([0.00012967527818940819, 2.97619393710823e-06, 1.2668668169841694e-08, 2.8801987217935931e-08, 4.8040963053960708e-08, 8.2858446803875748e-09])
pH6_n50=np.array([0.00013312689478588104, 2.6117827793561037e-06, 1.1465880772867307e-09, 7.4048590597963394e-09, 1.7348048499497734e-08, 4.7460540435167784e-10])
pH8_n50=np.array([0.00013787062153054091, 2.3421688049285676e-06, 1.2347315220993322e-10, 1.7178312848837624e-09, 5.4072503907939542e-09, 2.971173779647057e-11])
pH10_n50=np.array([0.00013526801192900124, 3.4675846200045931e-08, 1.4777989766161359e-17, 7.0336505905876709e-16, 1.2027626491134825e-14, 2.4192085243666904e-19])
pH12_n50=np.array([0.00013743057367948479, 0.00057700205823016447, 1.2274789277227654e-19, 4.1314759619071908e-11, 1.3856510977831681e-10, 3.8958535366860275e-23])

NO3_n50=np.array([4.3683387700727359e-05,0.00012967527818940819,0.00013312689478588104,0.00013787062153054091,0.00013526801192900124,0.00013743057367948479])
NO2_n50=np.array([9.4257293481906612e-05,2.97619393710823e-06,2.6117827793561037e-06,2.3421688049285676e-06,3.4675846200045931e-08,0.00057700205823016447])
NO_n50=np.array([0.000269245568543949,1.2668668169841694e-08,1.1465880772867307e-09,1.2347315220993322e-10,1.4777989766161359e-17,1.2274789277227654e-19])
N2O_n50=np.array([4.8808065373787774e-05,2.8801987217935931e-08,7.4048590597963394e-09,1.7178312848837624e-09,7.0336505905876709e-16,4.1314759619071908e-11])
N2_n50=np.array([5.2885920780133285e-05,4.8040963053960708e-08,1.7348048499497734e-08,5.4072503907939542e-09,1.2027626491134825e-14,1.3856510977831681e-10])
NH4_n50=np.array([0.00010371054066315315,8.2858446803875748e-09,4.7460540435167784e-10,2.971173779647057e-11,2.4192085243666904e-19,3.8958535366860275e-23])

NO3_n50=NO3_n50*362.
NO2_n50=NO2_n50*362.
NO_n50=NO_n50*362.
N2O_n50=N2O_n50*362.
N2_n50=N2_n50*362.
NH4_n50=NH4_n50*362.


pH2_n50=pH2_n50*362.*V
pH4_n50=pH4_n50*362.*V   #to get corrected number of moles
pH6_n50=pH6_n50*362.*V
pH8_n50=pH8_n50*362.*V
pH10_n50=pH10_n50*362.*V
pH12_n50=pH12_n50*362.*V

pH2=np.sum(pH2_n50)+pH2_n50[4]+pH2_n50[3]
pH4=np.sum(pH4_n50)+pH4_n50[4]+pH4_n50[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n50)+pH6_n50[4]+pH6_n50[3]
pH8=np.sum(pH8_n50)+pH8_n50[4]+pH8_n50[3]
pH10=np.sum(pH10_n50)+pH10_n50[4]+pH10_n50[3]
pH12=np.sum(pH12_n50)+pH12_n50[4]+pH12_n50[3]

pH2_n50=pH2_n50/pH2
pH4_n50=pH4_n50/pH4
pH6_n50=pH6_n50/pH6
pH8_n50=pH8_n50/pH8
pH10_n50=pH10_n50/pH10
pH12_n50=pH12_n50/pH12

#print(pH2_n50)
#print(pH4_n50)
#print(pH6_n50)
#print(pH8_n50)
#print(pH10_n50)
#print(pH12_n50)

NO3_n50=np.array([0.06115682,9.76278502e-01,9.80389472e-01,9.83194614e-01,9.99743716e-01,1.92363140e-01])
NO2_n50=np.array([0.13196039,2.24066931e-02,1.92340124e-02,1.67026719e-02,2.56283499e-04,8.07636356e-01])
NO_n50=np.array([0.3769443,9.53778435e-05,8.44384511e-06,8.80522165e-07,1.09221701e-13,1.71811624e-16])
N2O_n50=np.array([0.06833138,2.16839797e-04,5.45317749e-05,1.22503435e-05,5.19845592e-12,5.78287399e-08])
N2_n50=np.array([0.07404039,3.61683122e-04,1.27756635e-04,3.85606404e-05,8.88942170e-11,1.93951163e-07])
NH4_n50=np.array([0.14519495,6.23811427e-05,3.49514756e-06,2.11882853e-07,1.78799739e-15,5.45307059e-20])



#H2=1E-60
#initial guess: (-4,-5,-6,-6,-6,-6)
#n=1.0E18

pH_n60=np.array([2,4,6,8,10,12])

pH2_n60=np.array([0.00022006928484987541, 0.00038698010772386052, 8.1482962546020798e-10, 2.6437998769787708e-05, 2.721880238625733e-05, 3.5959622991904474e-11])
pH4_n60=np.array([0.0002265861921536579, 0.00036718246676684183, 9.2490315812932204e-10, 2.9431919066671319e-05, 3.0862781090241406e-05, 3.4980312096803045e-11])
pH6_n60=np.array([0.00017952931964191796, 0.00036635970024674765, 9.958669183630949e-10, 4.0664918837561093e-05, 4.3492711979937039e-05, 3.1002446925742439e-11])
pH8_n60=np.array([0.00033101883164586939, 0.00027215114373416556, 1.0450998417299275e-10, 2.61508149069201e-05, 2.9437301958678659e-05, 1.4513329582429068e-12])
pH10_n60=np.array([0.00010818934115932119, 0.00060610437638568401, 9.2691512225889921e-13, 6.3011457336185071e-10, 7.3625750150190649e-10, 1.398756569619641e-15])
pH12_n60=np.array([0.00010624047257907961, 0.00060820608731745624, 4.1899749038635322e-16, 8.163429697464354e-11, 7.5421493538274457e-11, 2.4970683432597348e-20])

NO3_n60=np.array([0.00022006928484987541,0.0002265861921536579,0.00017952931964191796,0.00033101883164586939,0.00010818934115932119,0.00010624047257907961])
NO2_n60=np.array([0.00038698010772386052,0.00036718246676684183,0.00036635970024674765,0.00027215114373416556,0.00060610437638568401,0.00060820608731745624])
NO_n60=np.array([8.1482962546020798e-10,9.2490315812932204e-10,9.958669183630949e-10,1.0450998417299275e-10,9.2691512225889921e-13,4.1899749038635322e-16])
N2O_n60=np.array([2.6437998769787708e-05,2.9431919066671319e-05,4.0664918837561093e-05,2.61508149069201e-05,6.3011457336185071e-10,8.163429697464354e-11])
N2_n60=np.array([2.721880238625733e-05,3.0862781090241406e-05,4.3492711979937039e-05,2.9437301958678659e-05,7.3625750150190649e-10,7.5421493538274457e-11])
NH4_n60=np.array([3.5959622991904474e-11,3.4980312096803045e-11,3.1002446925742439e-11,1.4513329582429068e-12,1.398756569619641e-15,2.4970683432597348e-20])

NO3_n60=NO3_n60*362.
NO2_n60=NO2_n60*362.
NO_n60=NO_n60*362.
N2O_n60=N2O_n60*362.
N2_n60=N2_n60*362.
NH4_n60=NH4_n60*362.


pH2_n60=pH2_n60*362.*V
pH4_n60=pH4_n60*362.*V   #to get corrected number of moles
pH6_n60=pH6_n60*362.*V
pH8_n60=pH8_n60*362.*V
pH10_n60=pH10_n60*362.*V
pH12_n60=pH12_n60*362.*V

pH2=np.sum(pH2_n60)+pH2_n60[4]+pH2_n60[3]
pH4=np.sum(pH4_n60)+pH4_n60[4]+pH4_n60[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n60)+pH6_n60[4]+pH6_n60[3]
pH8=np.sum(pH8_n60)+pH8_n60[4]+pH8_n60[3]
pH10=np.sum(pH10_n60)+pH10_n60[4]+pH10_n60[3]
pH12=np.sum(pH12_n60)+pH12_n60[4]+pH12_n60[3]

pH2_n60=pH2_n60/pH2
pH4_n60=pH4_n60/pH4
pH6_n60=pH6_n60/pH6
pH8_n60=pH8_n60/pH8
pH10_n60=pH10_n60/pH10
pH12_n60=pH12_n60/pH12

#print(pH2_n60)
#print(pH4_n60)
#print(pH6_n60)
#print(pH8_n60)
#print(pH10_n60)
#print(pH12_n60)

NO3_n60=np.array([3.08063302e-01,3.17188117e-01,2.51369344e-01,4.63387050e-01,1.51462801e-01,1.48703111e-01])
NO2_n60=np.array([5.41712896e-01,5.14002703e-01,5.12961324e-01,3.80979279e-01,8.48533372e-01,8.51296450e-01])
NO_n60=np.array([1.14063671e-06,1.29473155e-06,1.39437065e-06,1.46301565e-07,1.29766167e-09,5.86464166e-13])
N2O_n60=np.array([3.70091501e-02,4.12004584e-02,5.69372957e-02,3.66080350e-02,8.82147143e-07,1.14262236e-07])
N2_n60=np.array([3.81021556e-02,4.32034597e-02,6.08966518e-02,4.12087265e-02,1.03074501e-06,1.05566273e-07])
NH4_n60=np.array([5.03379660e-08,4.89674116e-08,4.34083121e-08,2.03169377e-09,1.95822976e-12,3.49510710e-17])




#H2=1E-70
#initial guess: (-3.5,-5,-6,-6,-6,-6)
#n=1.0E18

pH_n70=np.array([2,4,6,8,10,12])

pH2_n70=np.array([0.00040854782193169853, 8.8188411492596999e-05, 7.4468175941138563e-05, 2.2001460049045759e-05, 1.9807015453400277e-05, 5.9525390248440303e-05])
pH4_n70=np.array([0.00032736781494713718, 6.20455606093736e-05, 3.4151359497028228e-05, 1.415773492363982e-05, 1.1469478768270341e-05, 0.0002394337984492195])
pH6_n70=np.array([0.00037605665222544682, 0.0003382568481349073, 7.8231866071771206e-20, 3.8505042354492755e-14, 8.9156568755461363e-16, 3.4238592008926268e-26])
pH8_n70=np.array([0.00071428335290105453, 7.1428236186357909e-44, 1.0089506535406513e-138, 2.5570537216320726e-152, 1.2815626800168984e-162, 8.992282166525088e-181])
pH10_n70=np.array([0.0002979489115428942, 0.00041638479462671979, 1.6561160387489876e-19, 2.2364698065103828e-14, 6.1857715937692078e-16, 3.5914516527179481e-26])
pH12_n70=np.array([0.00027034399700979784, 0.00044395179411862843, 3.3123400927363897e-20, 2.3863768973905847e-15, 6.0604241515428745e-17, 2.4436351905138415e-27])

NO3_n70=np.array([0.00040854782193169853,0.00032736781494713718,0.00037605665222544682,0.00071428335290105453,0.0002979489115428942,0.00027034399700979784])
NO2_n70=np.array([8.8188411492596999e-05,6.20455606093736e-05,0.0003382568481349073,7.1428236186357909e-44,0.00041638479462671979,0.00044395179411862843])
NO_n70=np.array([7.4468175941138563e-05,3.4151359497028228e-05,7.8231866071771206e-20,1.0089506535406513e-138,1.6561160387489876e-19,3.3123400927363897e-20])
N2O_n70=np.array([2.2001460049045759e-05,1.415773492363982e-05,3.8505042354492755e-14,2.5570537216320726e-152,2.2364698065103828e-14,2.3863768973905847e-15])
N2_n70=np.array([1.9807015453400277e-05,1.1469478768270341e-05,8.9156568755461363e-16,1.2815626800168984e-162,6.1857715937692078e-16,6.0604241515428745e-17])
NH4_n70=np.array([5.9525390248440303e-05,0.0002394337984492195,3.4238592008926268e-26,8.992282166525088e-181,3.5914516527179481e-26,2.4436351905138415e-27])

NO3_n70=NO3_n70*362.
NO2_n70=NO2_n70*362.
NO_n70=NO_n70*362.
N2O_n70=N2O_n70*362.
N2_n70=N2_n70*362.
NH4_n70=NH4_n70*362.


pH2_n70=pH2_n70*362.*V
pH4_n70=pH4_n70*362.*V   #to get corrected number of moles
pH6_n70=pH6_n70*362.*V
pH8_n70=pH8_n70*362.*V
pH10_n70=pH10_n70*362.*V
pH12_n70=pH12_n70*362.*V

pH2=np.sum(pH2_n70)+pH2_n70[4]+pH2_n70[3]
pH4=np.sum(pH4_n70)+pH4_n70[4]+pH4_n70[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n70)+pH6_n70[4]+pH6_n70[3]
pH8=np.sum(pH8_n70)+pH8_n70[4]+pH8_n70[3]
pH10=np.sum(pH10_n70)+pH10_n70[4]+pH10_n70[3]
pH12=np.sum(pH12_n70)+pH12_n70[4]+pH12_n70[3]

pH2_n70=pH2_n70/pH2
pH4_n70=pH4_n70/pH4
pH6_n70=pH6_n70/pH6
pH8_n70=pH8_n70/pH8
pH10_n70=pH10_n70/pH10
pH12_n70=pH12_n70/pH12

#print(pH2_n70)
#print(pH4_n70)
#print(pH6_n70)
#print(pH8_n70)
#print(pH10_n70)
#print(pH12_n70)

NO3_n70=np.array([0.57191808,0.45833596,5.26458834e-01,1.00000000e+000, 4.17100452e-01,3.78476256e-01])
NO2_n70=np.array([0.12345323,0.08686777,4.73541166e-01,9.99998613e-041,5.82899548e-01,6.21523744e-01])
NO_n70=np.array([0.10424654,0.0478141,1.09520352e-16,1.41253558e-135,2.31840668e-16,4.63721071e-17])
N2O_n70=np.array([0.03079941,0.01982174,5.39049624e-11,3.57988705e-149,3.13084737e-11,3.34088052e-12])
N2_n70=np.array([0.02772745,0.01605801,1.24814341e-12,1.79419368e-159,8.65949841e-13,8.48447412e-14])
NH4_n70=np.array([0.08332843,0.33522269,4.79321642e-23,1.25892367e-177,5.02769451e-23,3.42104100e-24])



#H2=1E-80
#initial guess: (-3,-5,-6,-6,-6,-6)
#n=1.0E18

pH_n80=np.array([2,4,6,8,10,12])

pH2_n80=np.array([0.00071426836137690301, 7.1426836903169059e-54, 1.0089308881937037e-157, 2.5569535352404794e-180, 1.2815124688406164e-200, 8.9921060061478684e-209])
pH4_n80=np.array([0.00071428624613845615, 7.1428581355815343e-54, 1.0089555292422972e-159, 2.5570784333609161e-184, 1.2815750661840835e-204, 8.9923256197246237e-213])
pH6_n80=np.array([0.00071428922428630947, 7.1428739425388912e-54, 1.0089577620343705e-161, 2.5570897508681976e-188, 1.2815807383742492e-208, 8.9923455195049243e-217])
pH8_n80=np.array([0.00071429827159054089, 7.1429491451037368e-54, 1.0089683846790001e-163, 2.55714359494302e-192, 1.2816077243372405e-212, 8.9924401939248395e-221])
pH10_n80=np.array([0.00071431507523759652, 7.1431070139728798e-54, 1.0089906842494957e-165, 2.5572566288792147e-196, 1.2816643755029443e-216, 8.9926389390554943e-225])
pH12_n80=np.array([0.00071434158688464988, 7.1433749304964553e-54, 1.0090285284643334e-167, 2.5574484625315944e-200, 1.2817605200805807e-220, 8.9929762259752632e-229])

NO3_n80=np.array([0.00071426836137690301,0.00071428624613845615,0.00071428922428630947,0.00071429827159054089,0.00071431507523759652,0.00071434158688464988])
NO2_n80=np.array([7.1426836903169059e-54,7.1428581355815343e-54,7.1428739425388912e-54,7.1429491451037368e-54,7.1431070139728798e-54,7.1433749304964553e-54])
NO_n80=np.array([1.0089308881937037e-157,1.0089555292422972e-159,1.0089577620343705e-161,1.0089683846790001e-163,1.0089906842494957e-165,1.0090285284643334e-167])
N2O_n80=np.array([2.5569535352404794e-180,2.5570784333609161e-184,2.5570897508681976e-188,2.55714359494302e-192,2.5572566288792147e-196,2.5574484625315944e-200])
N2_n80=np.array([1.2815124688406164e-200,1.2815750661840835e-204,1.2815807383742492e-208,1.2816077243372405e-212,1.2816643755029443e-216,1.2817605200805807e-220])
NH4_n80=np.array([8.9921060061478684e-209,8.9923256197246237e-213,8.9923455195049243e-217,8.9924401939248395e-221,8.9926389390554943e-225,8.9929762259752632e-229])

NO3_n80=NO3_n80*362.
NO2_n80=NO2_n80*362.
NO_n80=NO_n80*362.
N2O_n80=N2O_n80*362.
N2_n80=N2_n80*362.
NH4_n80=NH4_n80*362.


pH2_n80=pH2_n80*362.*V
pH4_n80=pH4_n80*362.*V   #to get corrected number of moles
pH6_n80=pH6_n80*362.*V
pH8_n80=pH8_n80*362.*V
pH10_n80=pH10_n80*362.*V
pH12_n80=pH12_n80*362.*V

pH2=np.sum(pH2_n80)+pH2_n80[4]+pH2_n80[3]
pH4=np.sum(pH4_n80)+pH4_n80[4]+pH4_n80[3]  #to double count N2 and N2O
pH6=np.sum(pH6_n80)+pH6_n80[4]+pH6_n80[3]
pH8=np.sum(pH8_n80)+pH8_n80[4]+pH8_n80[3]
pH10=np.sum(pH10_n80)+pH10_n80[4]+pH10_n80[3]
pH12=np.sum(pH12_n80)+pH12_n80[4]+pH12_n80[3]

pH2_n80=pH2_n80/pH2
pH4_n80=pH4_n80/pH4
pH6_n80=pH6_n80/pH6
pH8_n80=pH8_n80/pH8
pH10_n80=pH10_n80/pH10
pH12_n80=pH12_n80/pH12

#print(pH2_n80)
#print(pH4_n80)
#print(pH6_n80)
#print(pH8_n80)
#print(pH10_n80)
#print(pH12_n80)

NO3_n80=np.array([1.00000000e+000,1.00000000e+000,1.00000000e+000,1.00000000e+000,1.00000000e+000,1.00000000e+000])
NO2_n80=np.array([1.00000001e-050,9.99999394e-051,9.99997438e-051,9.99995300e-051,9.99993877e-051,9.99994269e-051])
NO_n80=np.array([1.41253756e-154,1.41253669e-156,1.41253393e-158,1.41253091e-160,1.41252890e-162,1.41252945e-164])
N2O_n80=np.array([3.57982192e-177,3.57990714e-181,3.57990806e-185,3.57993810e-189,3.58001212e-193,3.58014780e-197])
N2_n80=np.array([1.79416104e-197,1.79420376e-201,1.79420422e-205,1.79421927e-209,1.79425637e-213,1.79432437e-217])
NH4_n80=np.array([1.25892543e-205,1.25892465e-209,1.25892219e-213,1.25891950e-217,1.25891770e-221,1.25891820e-225])


#### BAR CHART

width=.1

plt.figure()
#H2=1E-1
plt.bar(pH_n1-.6,NO3_n1,width,color=cm.plasma(0.05),label='NO3')
plt.bar(pH_n1-.6,NO2_n1,width,bottom=NO3_n1,color=cm.plasma(0.2),label='NO2')
plt.bar(pH_n1-.6,NO_n1,width,bottom=NO3_n1+NO2_n1,color=cm.plasma(0.35),label='NO')
plt.bar(pH_n1-.6,N2O_n1*2.,width,bottom=NO3_n1+NO2_n1+NO_n1,color=cm.plasma(0.5),label='N2O')
plt.bar(pH_n1-.6,N2_n1*2.,width,bottom=NO3_n1+NO2_n1+NO_n1+N2O_n1*2.,color=cm.plasma(0.65),label='N2')
plt.bar(pH_n1-.6,NH4_n1,width,bottom=NO3_n1+NO2_n1+NO_n1+N2O_n1*2.+N2_n1*2.,color=cm.plasma(0.8),label='NH4')

#H2=1E-3
plt.bar(pH_n3-.5,NO3_n3,width,color=cm.plasma(0.05))
plt.bar(pH_n3-.5,NO2_n3,width,bottom=NO3_n3,color=cm.plasma(0.2))
plt.bar(pH_n3-.5,NO_n3,width,bottom=NO3_n3+NO2_n3,color=cm.plasma(0.35))
plt.bar(pH_n3-.5,N2O_n3*2.,width,bottom=NO3_n3+NO2_n3+NO_n3,color=cm.plasma(0.5))
plt.bar(pH_n3-.5,N2_n3*2.,width,bottom=NO3_n3+NO2_n3+NO_n3+N2O_n3*2.,color=cm.plasma(0.65))
plt.bar(pH_n3-.5,NH4_n3,width,bottom=NO3_n3+NO2_n3+NO_n3+N2O_n3*2.+N2_n3*2.,color=cm.plasma(0.8))

#H2=1E-5 
plt.bar(pH_n5-.4,NO3_n5,width,color=cm.plasma(0.05))
plt.bar(pH_n5-.4,NO2_n5,width,bottom=NO3_n5,color=cm.plasma(0.2))
plt.bar(pH_n5-.4,NO_n5,width,bottom=NO3_n5+NO2_n5,color=cm.plasma(0.35))
plt.bar(pH_n5-.4,N2O_n5*2.,width,bottom=NO3_n5+NO2_n5+NO_n5,color=cm.plasma(0.5))
plt.bar(pH_n5-.4,N2_n5*2.,width,bottom=NO3_n5+NO2_n5+NO_n5+N2O_n5*2.,color=cm.plasma(0.65))
plt.bar(pH_n5-.4,NH4_n5,width,bottom=NO3_n5+NO2_n5+NO_n5+N2O_n5*2.+N2_n5*2.,color=cm.plasma(0.8))

#H2=1E-8
plt.bar(pH_n8-.3,NO3_n8,width,color=cm.plasma(0.05))
plt.bar(pH_n8-.3,NO2_n8,width,bottom=NO3_n8,color=cm.plasma(0.2))
plt.bar(pH_n8-.3,NO_n8,width,bottom=NO3_n8+NO2_n8,color=cm.plasma(0.35))
plt.bar(pH_n8-.3,N2O_n8*2.,width,bottom=NO3_n8+NO2_n8+NO_n8,color=cm.plasma(0.5))
plt.bar(pH_n8-.3,N2_n8*2.,width,bottom=NO3_n8+NO2_n8+NO_n8+N2O_n8*2.,color=cm.plasma(0.65))
plt.bar(pH_n8-.3,NH4_n8,width,bottom=NO3_n8+NO2_n8+NO_n8+N2O_n8*2.+N2_n8*2.,color=cm.plasma(0.8))

#H2=1E-10
plt.bar(pH_n10-.2,NO3_n10,width,color=cm.plasma(0.05))
plt.bar(pH_n10-.2,NO2_n10,width,bottom=NO3_n10,color=cm.plasma(0.2))
plt.bar(pH_n10-.2,NO_n10,width,bottom=NO3_n10+NO2_n10,color=cm.plasma(0.35))
plt.bar(pH_n10-.2,N2O_n10*2.,width,bottom=NO3_n10+NO2_n10+NO_n10,color=cm.plasma(0.5))
plt.bar(pH_n10-.2,N2_n10*2.,width,bottom=NO3_n10+NO2_n10+NO_n10+N2O_n10*2.,color=cm.plasma(0.65))
plt.bar(pH_n10-.2,NH4_n10,width,bottom=NO3_n10+NO2_n10+NO_n10+N2O_n10*2.+N2_n10*2.,color=cm.plasma(0.8))

#H2=1E-15
plt.bar(pH_n15-.1,NO3_n15,width,color=cm.plasma(0.05))
plt.bar(pH_n15-.1,NO2_n15,width,bottom=NO3_n15,color=cm.plasma(0.2))
plt.bar(pH_n15-.1,NO_n15,width,bottom=NO3_n15+NO2_n15,color=cm.plasma(0.35))
plt.bar(pH_n15-.1,N2O_n15*2.,width,bottom=NO3_n15+NO2_n15+NO_n15,color=cm.plasma(0.5))
plt.bar(pH_n15-.1,N2_n15*2.,width,bottom=NO3_n15+NO2_n15+NO_n15+N2O_n15*2.,color=cm.plasma(0.65))
plt.bar(pH_n15-.1,NH4_n15,width,bottom=NO3_n15+NO2_n15+NO_n15+N2O_n15*2.+N2_n15*2.,color=cm.plasma(0.8))

#H2=1E-30
plt.bar(pH_n30,NO3_n30,width,color=cm.plasma(0.05))
plt.bar(pH_n30,NO2_n30,width,bottom=NO3_n30,color=cm.plasma(0.2))
plt.bar(pH_n30,NO_n30,width,bottom=NO3_n30+NO2_n30,color=cm.plasma(0.35))
plt.bar(pH_n30,N2O_n30*2.,width,bottom=NO3_n30+NO2_n30+NO_n30,color=cm.plasma(0.5))
plt.bar(pH_n30,N2_n30*2.,width,bottom=NO3_n30+NO2_n30+NO_n30+N2O_n30*2.,color=cm.plasma(0.65))
plt.bar(pH_n30,NH4_n30,width,bottom=NO3_n30+NO2_n30+NO_n30+N2O_n30*2.+N2_n30*2.,color=cm.plasma(0.8))

#H2=1E-35
plt.bar(pH_n35+.1,NO3_n35,width,color=cm.plasma(0.05))
plt.bar(pH_n35+.1,NO2_n35,width,bottom=NO3_n35,color=cm.plasma(0.2))
plt.bar(pH_n35+.1,NO_n35,width,bottom=NO3_n35+NO2_n35,color=cm.plasma(0.35))
plt.bar(pH_n35+.1,N2O_n35*2.,width,bottom=NO3_n35+NO2_n35+NO_n35,color=cm.plasma(0.5))
plt.bar(pH_n35+.1,N2_n35*2.,width,bottom=NO3_n35+NO2_n35+NO_n35+N2O_n35*2.,color=cm.plasma(0.65))
plt.bar(pH_n35+.1,NH4_n35,width,bottom=NO3_n35+NO2_n35+NO_n35+N2O_n35*2.+N2_n35*2.,color=cm.plasma(0.8))

#H2=1E-50
plt.bar(pH_n50+.2,NO3_n50,width,color=cm.plasma(0.05))
plt.bar(pH_n50+.2,NO2_n50,width,bottom=NO3_n50,color=cm.plasma(0.2))
plt.bar(pH_n50+.2,NO_n50,width,bottom=NO3_n50+NO2_n50,color=cm.plasma(0.35))
plt.bar(pH_n50+.2,N2O_n50*2.,width,bottom=NO3_n50+NO2_n50+NO_n50,color=cm.plasma(0.5))
plt.bar(pH_n50+.2,N2_n50*2.,width,bottom=NO3_n50+NO2_n50+NO_n50+N2O_n50*2.,color=cm.plasma(0.65))
plt.bar(pH_n50+.2,NH4_n50,width,bottom=NO3_n50+NO2_n50+NO_n50+N2O_n50*2.+N2_n50*2.,color=cm.plasma(0.8))

#H2=1E-60
plt.bar(pH_n60+.3,NO3_n60,width,color=cm.plasma(0.05))
plt.bar(pH_n60+.3,NO2_n60,width,bottom=NO3_n60,color=cm.plasma(0.2))
plt.bar(pH_n60+.3,NO_n60,width,bottom=NO3_n60+NO2_n60,color=cm.plasma(0.35))
plt.bar(pH_n60+.3,N2O_n60*2.,width,bottom=NO3_n60+NO2_n60+NO_n60,color=cm.plasma(0.5))
plt.bar(pH_n60+.3,N2_n60*2.,width,bottom=NO3_n60+NO2_n60+NO_n60+N2O_n60*2.,color=cm.plasma(0.65))
plt.bar(pH_n60+.3,NH4_n60,width,bottom=NO3_n60+NO2_n60+NO_n60+N2O_n60*2.+N2_n60*2.,color=cm.plasma(0.8))

#H2=1E-70
plt.bar(pH_n70+.4,NO3_n70,width,color=cm.plasma(0.05))
plt.bar(pH_n70+.4,NO2_n70,width,bottom=NO3_n70,color=cm.plasma(0.2))
plt.bar(pH_n70+.4,NO_n70,width,bottom=NO3_n70+NO2_n70,color=cm.plasma(0.35))
plt.bar(pH_n70+.4,N2O_n70*2.,width,bottom=NO3_n70+NO2_n70+NO_n70,color=cm.plasma(0.5))
plt.bar(pH_n70+.4,N2_n70*2.,width,bottom=NO3_n70+NO2_n70+NO_n70+N2O_n70*2.,color=cm.plasma(0.65))
plt.bar(pH_n70+.4,NH4_n70,width,bottom=NO3_n70+NO2_n70+NO_n70+N2O_n70*2.+N2_n70*2.,color=cm.plasma(0.8))

#H2=1E-80
plt.bar(pH_n80+.5,NO3_n80,width,color=cm.plasma(0.05))
plt.bar(pH_n80+.5,NO2_n80,width,bottom=NO3_n80,color=cm.plasma(0.2))
plt.bar(pH_n80+.5,NO_n80,width,bottom=NO3_n80+NO2_n80,color=cm.plasma(0.35))
plt.bar(pH_n80+.5,N2O_n80*2.,width,bottom=NO3_n80+NO2_n80+NO_n80,color=cm.plasma(0.5))
plt.bar(pH_n80+.5,N2_n80*2.,width,bottom=NO3_n80+NO2_n80+NO_n80+N2O_n80*2.,color=cm.plasma(0.65))
plt.bar(pH_n80+.5,NH4_n80,width,bottom=NO3_n80+NO2_n80+NO_n80+N2O_n80*2.+N2_n80*2.,color=cm.plasma(0.8))



plt.legend(loc='best')
plt.xlabel('pH',fontsize=16)
plt.ylabel('Fraction N atoms per species',fontsize=16)
plt.show()
plt.close()


##### SIMPLER BAR CHART FOR PAPER

#### BAR CHART

width=.2

plt.figure()


#H2=1E-5 
plt.bar(pH_n5-.6,NO3_n5,width,color=cm.plasma(0.05),label='NO$_3$')
plt.bar(pH_n5-.6,NO2_n5,width,bottom=NO3_n5,color=cm.plasma(0.2),label='NO$_2$')
plt.bar(pH_n5-.6,NO_n5,width,bottom=NO3_n5+NO2_n5,color=cm.plasma(0.35),label='NO')
plt.bar(pH_n5-.6,N2O_n5*2.,width,bottom=NO3_n5+NO2_n5+NO_n5,color=cm.plasma(0.5),label='N$_2$O')
plt.bar(pH_n5-.6,N2_n5*2.,width,bottom=NO3_n5+NO2_n5+NO_n5+N2O_n5*2.,color=cm.plasma(0.65),label='N$_2$')
plt.bar(pH_n5-.6,NH4_n5,width,bottom=NO3_n5+NO2_n5+NO_n5+N2O_n5*2.+N2_n5*2.,color=cm.plasma(0.8),label='NH$_4$')


#H2=1E-10
plt.bar(pH_n10-.4,NO3_n10,width,color=cm.plasma(0.05))
plt.bar(pH_n10-.4,NO2_n10,width,bottom=NO3_n10,color=cm.plasma(0.2))
plt.bar(pH_n10-.4,NO_n10,width,bottom=NO3_n10+NO2_n10,color=cm.plasma(0.35))
plt.bar(pH_n10-.4,N2O_n10*2.,width,bottom=NO3_n10+NO2_n10+NO_n10,color=cm.plasma(0.5))
plt.bar(pH_n10-.4,N2_n10*2.,width,bottom=NO3_n10+NO2_n10+NO_n10+N2O_n10*2.,color=cm.plasma(0.65))
plt.bar(pH_n10-.4,NH4_n10,width,bottom=NO3_n10+NO2_n10+NO_n10+N2O_n10*2.+N2_n10*2.,color=cm.plasma(0.8))

#H2=1E-15
plt.bar(pH_n15-.2,NO3_n15,width,color=cm.plasma(0.05))
plt.bar(pH_n15-.2,NO2_n15,width,bottom=NO3_n15,color=cm.plasma(0.2))
plt.bar(pH_n15-.2,NO_n15,width,bottom=NO3_n15+NO2_n15,color=cm.plasma(0.35))
plt.bar(pH_n15-.2,N2O_n15*2.,width,bottom=NO3_n15+NO2_n15+NO_n15,color=cm.plasma(0.5))
plt.bar(pH_n15-.2,N2_n15*2.,width,bottom=NO3_n15+NO2_n15+NO_n15+N2O_n15*2.,color=cm.plasma(0.65))
plt.bar(pH_n15-.2,NH4_n15,width,bottom=NO3_n15+NO2_n15+NO_n15+N2O_n15*2.+N2_n15*2.,color=cm.plasma(0.8))

#H2=1E-30
plt.bar(pH_n30,NO3_n30,width,color=cm.plasma(0.05))
plt.bar(pH_n30,NO2_n30,width,bottom=NO3_n30,color=cm.plasma(0.2))
plt.bar(pH_n30,NO_n30,width,bottom=NO3_n30+NO2_n30,color=cm.plasma(0.35))
plt.bar(pH_n30,N2O_n30*2.,width,bottom=NO3_n30+NO2_n30+NO_n30,color=cm.plasma(0.5))
plt.bar(pH_n30,N2_n30*2.,width,bottom=NO3_n30+NO2_n30+NO_n30+N2O_n30*2.,color=cm.plasma(0.65))
plt.bar(pH_n30,NH4_n30,width,bottom=NO3_n30+NO2_n30+NO_n30+N2O_n30*2.+N2_n30*2.,color=cm.plasma(0.8))


#H2=1E-50
plt.bar(pH_n50+.2,NO3_n50,width,color=cm.plasma(0.05))
plt.bar(pH_n50+.2,NO2_n50,width,bottom=NO3_n50,color=cm.plasma(0.2))
plt.bar(pH_n50+.2,NO_n50,width,bottom=NO3_n50+NO2_n50,color=cm.plasma(0.35))
plt.bar(pH_n50+.2,N2O_n50*2.,width,bottom=NO3_n50+NO2_n50+NO_n50,color=cm.plasma(0.5))
plt.bar(pH_n50+.2,N2_n50*2.,width,bottom=NO3_n50+NO2_n50+NO_n50+N2O_n50*2.,color=cm.plasma(0.65))
plt.bar(pH_n50+.2,NH4_n50,width,bottom=NO3_n50+NO2_n50+NO_n50+N2O_n50*2.+N2_n50*2.,color=cm.plasma(0.8))


#H2=1E-70
plt.bar(pH_n70+.4,NO3_n70,width,color=cm.plasma(0.05))
plt.bar(pH_n70+.4,NO2_n70,width,bottom=NO3_n70,color=cm.plasma(0.2))
plt.bar(pH_n70+.4,NO_n70,width,bottom=NO3_n70+NO2_n70,color=cm.plasma(0.35))
plt.bar(pH_n70+.4,N2O_n70*2.,width,bottom=NO3_n70+NO2_n70+NO_n70,color=cm.plasma(0.5))
plt.bar(pH_n70+.4,N2_n70*2.,width,bottom=NO3_n70+NO2_n70+NO_n70+N2O_n70*2.,color=cm.plasma(0.65))
plt.bar(pH_n70+.4,NH4_n70,width,bottom=NO3_n70+NO2_n70+NO_n70+N2O_n70*2.+N2_n70*2.,color=cm.plasma(0.8))


plt.xlim(3,11)
plt.xticks([4,6,8,10])
#plt.legend(loc='upper right')
plt.xlabel('pH',fontsize=16)
plt.ylabel('Fraction N atoms per species',fontsize=16)
plt.show()
plt.close()


#REDUCING POWER SUBPLOT

x=np.array([1,2,3,4,5,6])
logH2=np.array([-5,-10,-15,-30,-50,-70])
H2=np.array([1.0E-5,1.0E-10,1.0E-15,1.0E-30,1.0E-50,1.0E-70])


plt.figure()
plt.plot(x,logH2,marker='o',color='k',markersize=10)
plt.ylabel('log(H$_2$)',fontsize=16)
#plt.yscale('log')
plt.tick_params(which='y',labelsize=14,pad=5)
plt.xlim(0,7)
plt.ylim(-75,0)
plt.show()
plt.close()


